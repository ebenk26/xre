</div>
<!-- END CONTAINER -->

<?php $this->load->view('main/footer_app');?>
<!-- ========== Javascript ========== -->
<!-- CORE  -->
<!-- <script type="text/javascript" src="<?php echo JS; ?>layout8/vendor/jquery-v1-11.min.js"></script> -->
<!-- <script type="text/javascript" src="<?php echo JS; ?>layout8/vendor/jquery.migrate.min.js"></script> -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/js.cookie.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery.blockui.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-switch/js/bootstrap-switch.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/moment.min.js"></script>

<!-- Plugins @ Vendor  -->
<!-- # Datatable -->
<script type="text/javascript" src="<?php echo JS; ?>global/datatable.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/datatables/datatables.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/datatables/plugins/bootstrap/datatables.bootstrap.js"></script>
<!-- # Date / Time -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-daterangepicker/daterangepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/clockface/js/clockface.js"></script>
<!-- # Widget -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/counterup/jquery.waypoints.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/counterup/jquery.counterup.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-tabdrop/bootstrap-tabdrop.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-fileinput/bootstrap-fileinput.js"></script>
<!-- # Calendar -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/fullcalendar/fullcalendar.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-ui/jquery-ui.min.js"></script>
<!-- # Image Cropping -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jcrop/js/jquery.color.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jcrop/js/jquery.Jcrop.min.js"></script>
<!-- # Forms -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/typeahead/handlebars.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/typeahead/typeahead.bundle.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/autosize/autosize.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-repeater/jquery.repeater.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-select/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/select2/js/select2.full.min.js"></script>
<!-- # Text Editor -->
<!-- Note : Took from page component_editors.html -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wysihtml5/wysihtml5-0.3.0.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-markdown/lib/markdown.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-summernote/summernote.min.js"></script>
<!-- # Charts -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/morris/morris.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/morris/raphael-min.js"></script>
<!-- # Notifications -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-sweetalert/sweetalert.min.js"></script>
<!-- # Portfolio @ Light Gallery -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/cubeportfolio/js/jquery.cubeportfolio.min.js"></script>
<!-- # Validation -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-validation/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-validation/js/additional-methods.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
<!-- # Custom -->
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/alertify.min.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/pass-strength.js"></script>s
<script type="text/javascript" src="<?php echo base_url(); ?>assets/global/plugins/Croppic/croppic.js"></script>

<!-- GLOBAL -->
<script type="text/javascript" src="<?php echo JS; ?>global/app.min.js"></script>

<!-- APPS -->
<script type="text/javascript" src="<?php echo JS; ?>apps/calendar.js"></script>

<!-- PAGE -->
<script type="text/javascript" src="<?php echo JS; ?>pages/form-wizard-employer.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/dashboard.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/table-datatables-managed.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/form-repeater.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/components-date-time-pickers.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/form-image-crop.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/components-bootstrap-select.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/ui-modals.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/components-editors.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/ui-sweetalert.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/portfolio-3.js"></script>

<!-- PAGE LAYOUT   -->
<script type="text/javascript" src="<?php echo JS; ?>layout2/layout.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>layout2/quick-sidebar.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>layout2/quick-nav.min.js"></script>






<script>
    $(document).ready(function () {
        var cropperOptions = {
            //uploadUrl:'<?=base_url()?>assets/global/plugins/Croppic/croppic/img_save_to_file.php',
            uploadUrl: '<?=base_url()?>student/gallery/img_save_to_file',
            cropUrl: '<?=base_url()?>student/gallery/img_crop_to_file',
            //cropUrl:'<?=base_url()?>assets/global/plugins/Croppic/croppic/img_crop_to_file.php',
            outputUrlId: 'myOutputId',
            imgEyecandy: false,
            imgEyecandyOpacity: 0.2,
            uploadData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            cropData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            rotateControls: false,
        };

        var cropperOptionsEdit = {
            uploadUrl: '<?=base_url()?>student/gallery/img_save_to_file',
            cropUrl: '<?=base_url()?>student/gallery/img_crop_to_file',
            outputUrlId: 'myOutputIdEdit',
            imgEyecandy: false,
            imgEyecandyOpacity: 0.2,
            uploadData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            cropData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            rotateControls: false,
        };

        var cropper = new Croppic('yourId', cropperOptions);

        var cropper_edit = new Croppic('yourIdEdit', cropperOptionsEdit);

        //cropper.destroy()   // no need explaining here :) 
        //cropper.reset()
        /*
            onBeforeImgUpload:  function(){ console.log('onBeforeImgUpload') },
            onAfterImgUpload:   function(){ console.log('onAfterImgUpload') },
            onImgDrag:      function(){ console.log('onImgDrag') },
            onImgZoom:      function(){ console.log('onImgZoom') },
            onBeforeImgCrop:    function(){ console.log('onBeforeImgCrop') },
            onAfterImgCrop:     function(){ console.log('onAfterImgCrop') },
            onReset:        function(){ console.log('onReset') },
            onError:        function(errormsg){ console.log('onError:'+errormsg)
            */

        //EDIT PHOTO GALLERY
        $(".edit_button_gallery").on("click", function () {
            //$('#featured_image_article').hide();
            var row_id = this.id;
            var res = row_id.split("_");

            row_id = res[1];
            $.ajax({
                url: "<?=base_url();?>student/gallery/get_data_array/" + row_id,
                method: "POST",
                success: function (response) {
                    var data = JSON.parse(response);
                    $('#title_gallery').val(data.title);
                    $('#description_gallery').val(data.description);
                    $('#myOutputIdEdit').val("/" + data.photo);
                    $('#myOutputIdEditOld').val("/" + data.photo);
                    $('#id_gallery').val(data.id);
                    $('#curr_photo').attr("src", "<?=base_url();?>assets/img/gallery/" + data.photo);

                    /*cropper_edit.destroy();                        
                    cropperOptionsEdit = {
                        uploadUrl:'<?=base_url()?>student/gallery/img_save_to_file',
                        cropUrl:'<?=base_url()?>student/gallery/img_crop_to_file',
                        outputUrlId:'myOutputIdEdit',
                        loadPicture:'<?=base_url();?>assets/img/gallery/'+data.photo,
                        imgEyecandy:false,
                        imgEyecandyOpacity:0.2,
                        rotateControls:false,
                    };
                    cropper_edit = new Croppic('yourIdEdit', cropperOptionsEdit);*/
                    cropper_edit.reset();

                }
            });
        });

        //SAVE PHOTO GALLERY
        $("#button_save_gallery").on("click", function () {
            if ($("#myOutputId").val() == "") {
                alert("You have not upload any photo yet!");
                return false;
            }
        });

        var last_seen_notif = "<?=$this->session->userdata('last_seen_notif')?>";
        var e = $("#xremo_table");
        e.dataTable({
            language: {
                aria: {
                    sortAscending: ": activate to sort column ascending",
                    sortDescending: ": activate to sort column descending"
                },
                emptyTable: "No data available in table",
                info: "Showing _START_ to _END_ of _TOTAL_ records",
                infoEmpty: "No records found",
                infoFiltered: "(filtered1 from _MAX_ total records)",
                lengthMenu: "Show _MENU_",
                search: "Search:",
                zeroRecords: "No matching records found",
                paginate: {
                    previous: "Prev",
                    next: "Next",
                    last: "Last",
                    first: "First"
                }
            },
            bStateSave: !0,
            lengthMenu: [
                [5, 15, 20, -1],
                [5, 15, 20, "All"]
            ],
            pageLength: 5,
            pagingType: "bootstrap_full_number",
            columnDefs: [{
                orderable: !1,
                targets: [0]
            }, {
                searchable: !1,
                targets: [0]
            }, {
                className: "dt-right"
            }],
            order: [
                //[1, "asc"]
            ]
        });

        $('#DOB').datepicker({
            format: 'dd-mm-yyyy',
            autoclose: true,
        });


        $(".date-picker-start").datepicker({
            format: 'dd-mm-yyyy',
            todayBtn: 1,
            autoclose: true,
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            $('.date-picker-end').datepicker('setStartDate', minDate);
        });

        $(".date-picker-end").datepicker({
            format: 'dd-mm-yyyy',
            autoclose: true,
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            $('.date-picker-start').datepicker('setEndDate', minDate);
        });

        $(".date-picker-start").keyup(function () {
            if (!this.value) {
                $(this).datepicker("clearDates");
            }
        });

        $(".date-picker-end").keyup(function () {
            if (!this.value) {
                $(this).datepicker("clearDates");
            }
        });


        $('.md-check').change(function () {
            if (this.checked) {
                $('.input-date-picker-end').prop("disabled", true);
                $('.input-date-picker-end').removeAttr("required");
            } else {
                $('.input-date-picker-end').removeAttr("disabled");
                $('.input-date-picker-end').attr("required");
            }
        });

        <?php if($this->session->flashdata('msg_success')){ ?>
        alertify.success('<?php echo $this->session->flashdata('
            msg_success '); ?>', 'success', 5);
        <?php } ?>
        <?php if($this->session->flashdata('msg_failed')){ ?>
        alertify.error('<?php echo $this->session->flashdata('
            msg_failed '); ?>', 'error', 5);
        <?php } ?>

        $(".btn-delete").click(function () {
            var data = $(this).attr('data-value');
            var table = $(this).attr('tb-val');
            alertify.confirm('Delete From List', 'Are you sure you want to delete?', function () {
                $.post("<?php echo base_url(); ?>student/profile/delete/", {
                    id: data,
                    table: table
                }, function (data) {
                    if (data == "false") {
                        alertify.error('Failed to delete record');
                    } else {
                        alertify.success('Record is deleted.');
                        location.reload();
                    }
                });
            }, function (data) {
                alertify.error('Cancel');
            });
        });
        $('.apply').click(function () {
            var apply = $(this).attr('id');
            swal({
                    title: "Are you sure?",
                    text: "You will apply this as your dream job",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Apply",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/dashboard/applied",
                            method: "POST",
                            data: {
                                job_id: parseInt(apply),
                            },
                            success: function (response) {
                                swal("Sucess", "Success apply your dream job.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "This job is not fit for you", "error");
                    }
                }
            );
        });
        $('.dlt-history').click(function () {
            var apply = $(this).attr('data-id');
            swal({
                    title: "Are you sure you want to withdraw?",
                    text: "You withdraw from this job",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "withdraw",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/applications_history/withdraw",
                            method: "POST",
                            data: {
                                job_id: parseInt(apply),
                            },
                            success: function (response) {
                                swal("Sucess", "Success withdraw this job.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "This job still fit for you", "error");
                    }
                }
            );
        });

        $('.btn-acc').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            swal({
                    title: "Are you sure you want to accept the invitation?",
                    text: "You accept the invitation",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Accept",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/applications_history/accept_invitation",
                            method: "POST",
                            data: {
                                job_id: parseInt(job_id),
                                session_id: parseInt(session_id),
                                employer_id: parseInt(employer_id)
                            },
                            success: function (response) {
                                console.log(response);
                                swal("Sucess", "Success accept the invitation.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "You still thinking about other possibilities", "error");
                    }
                }
            );
        });

        $('.btn-resc').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            $('#modal_rescheduled_form .job-id').val(job_id);
            $('#modal_rescheduled_form .session-id').val(session_id);
            $('#modal_rescheduled_form .employer-id').val(employer_id);
        });

        $('.btn-rej').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            $('#modal_reject_form .job-id').val(job_id);
            $('#modal_reject_form .session-id').val(session_id);
            $('#modal_reject_form .employer-id').val(employer_id);
        });

        $("#searchable_detail").bootstrapSwitch({
            size: 'mini',
            onSwitchChange: function (event, state) {
                var parentClass = $(this).parent().parent();
                var searchable_detail = 0;

                if (parentClass.hasClass('bootstrap-switch-on')) {
                    searchable_detail = 1;
                }

                $.ajax({
                    url: "<?php echo base_url();?>student/settings/changeSearchableDetail",
                    method: "POST",
                    data: {
                        status: searchable_detail
                    },
                    success: function (response) {
                        if (searchable_detail == 1) {
                            swal("Success", "Your contact detail are now searchable to employers.", "success");
                        } else {
                            swal("Success", "Your contact detail are now unavailable to employers.", "success");
                        }
                    }
                });
            }
        });

        $("#searchable").bootstrapSwitch({
            size: 'mini',
            onSwitchChange: function (event, state) {
                var parentClass = $(this).parent().parent();
                var searchable = 0;

                if (parentClass.hasClass('bootstrap-switch-on')) {
                    searchable = 1;
                }

                $.ajax({
                    url: "<?php echo base_url();?>student/settings/changeSearchable",
                    method: "POST",
                    data: {
                        status: searchable
                    },
                    success: function (response) {
                        if (searchable == 1) {
                            $("#searchable_detail_content").addClass('hidden');
                            $('#searchable_detail').bootstrapSwitch('state', false);
                            swal("Success", "Your contact are now unavailable to employers.", "success");
                        } else {
                            $('#searchable_detail').bootstrapSwitch('state', true);
                            $("#searchable_detail_content").removeClass('hidden');
                            swal("Success", "Your contact are now searchable to employers.", "success");
                        }
                    }
                });
            }
        });

        <?php if ($this->uri->segment(2) == 'dashboard' || $this->uri->segment(2) == 'calendar') {?>
        var AppCalendar = function () {

            return {
                //main function to initiate the module
                init: function () {
                    this.initCalendar();
                },

                initCalendar: function () {

                    if (!jQuery().fullCalendar) {
                        return;
                    }

                    var date = new Date();
                    var d = date.getDate();
                    var m = date.getMonth();
                    var y = date.getFullYear();

                    var h = {};

                    if (App.isRTL()) {
                        if ($('#fullcalendar').parents(".portlet").width() <= 720) {
                            $('#fullcalendar').addClass("mobile");
                            h = {
                                right: 'title, prev, next',
                                center: '',
                                // left: 'agendaDay, agendaWeek, month, today'
                                left: ' month, today'
                            };
                        } else {
                            $('#fullcalendar').removeClass("mobile");
                            h = {
                                right: 'title',
                                center: '',
                                // left: 'agendaDay, agendaWeek, month, today, prev,next'
                                left: ' month, today, prev,next'
                            };
                        }
                    } else {
                        if ($('#fullcalendar').parents(".portlet ").width() <= 720) {
                            $('#fullcalendar').addClass("mobile");
                            h = {
                                left: 'title, prev, next',
                                center: '',
                                // right: 'today,month,agendaWeek,agendaDay'
                                right: 'month,agendaWeek'
                            };
                        } else {
                            $('#fullcalendar').removeClass("mobile");
                            h = {
                                left: 'title',
                                center: '',
                                // right: 'prev,next,today,month,agendaWeek,agendaDay'
                                right: 'prev,next,month,agendaWeek'
                            };
                        }
                    }

                    $('#fullcalendar').fullCalendar('destroy');
                    var invitation = <?php echo $invitation; ?>;
                    var invitation_calendar = [];
                    $.each(invitation, function (i, v) {
                        var color = '';

                        if (v.status == 'accept') {
                            color = 'green';
                        } else if (v.status == 'reject') {
                            color = 'red';
                        } else if (v.status == 'pending') {
                            color = 'yellow';
                        } else if (v.status == 'reschedule') {
                            color = 'blue';
                        } else {
                            color = 'grey';
                        }

                        invitation_calendar.push({
                            id: v.id,
                            title: v.title,
                            start: v.start_date,
                            end: v.end_date,
                            backgroundColor: App.getBrandColor(color)
                        })
                    });

                    $('#fullcalendar').fullCalendar({
                        header: h,
                        defaultView: 'month',
                        slotMinutes: 15,
                        editable: false,
                        droppable: false,
                        events: invitation_calendar,
                        eventClick: function (invitation_calendar, jsEvent, view) {
                            $('#modal_info_' + invitation_calendar.id).modal();
                        },
                    });

                }

            };

        }();

        AppCalendar.init();
        <?php } ?>

        $('#notif_msg').slimScroll({
            height: '250px'
        });

        showNotif();

        setInterval(function () {
            showNotif()
        }, <?= GetInterval(); ?>);

        $("#count_notif").on("click", function () {
            $.ajax({
                url: "<?php echo base_url();?>setLastSeenNotif",
                method: "POST",
                success: function (response) {
                    //var data = JSON.parse(response);
                    //last_seen_notif = data.last_seen_notif;
                }
            });
        });
    });

    function showNotif() {
        $.ajax({
            url: "<?php echo base_url();?>notif",
            method: "POST",
            success: function (response) {
                var data = JSON.parse(response);

                if (data.message == "success") {
                    $("#notif_msg").html(data.notif);
                    $("#count_notif").html(data.total);
                    $("#count_notif_in").html(data.total_in);
                }
            }
        });
    }

    function notif_list(param) {
        var source = param.getAttribute('data-source');

        $.ajax({
            url: "<?php echo base_url();?>clear-notif",
            method: "POST",
            data: {
                id: source
            },
            success: function (response) {
                var data = JSON.parse(response);

                if (data.message == "success") {
                    location.href = data.url;
                }
            }
        });
    }

    // For Edit Profile
    $('.nav.navProfile li a').click(function (e) {
        //remove all pre-existing active classes
        $('.nav.navProfile li.active').removeClass('active');

        var $parent = $(this).parent();
        $parent.addClass('active');
        //Load the content
        //e.g.
        //load the page that the link was pointing to
        $('.navProfile').load($(this).find(a).attr('href'));
        //$('.navProfile').load($(this).attr('href'));
        e.preventDefault();
    });

</script>

</body>

</html>
