</div>
<!-- END CONTAINER -->

<?php $this->load->view('main/footer_app');?>

<!-- ========== Javascript ========== -->
<!-- CORE  -->
<!-- <script type="text/javascript" src="<?php echo JS; ?>layout8/vendor/jquery-v1-11.min.js"></script> -->
<!-- <script type="text/javascript" src="<?php echo JS; ?>layout8/vendor/jquery.migrate.min.js"></script> -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/js.cookie.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery.blockui.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-switch/js/bootstrap-switch.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/moment.min.js"></script>

<!-- Plugins @ Vendor  -->
<!-- # Date / Time -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-daterangepicker/daterangepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/clockface/js/clockface.js"></script>
<!-- # Datatable -->
<script type="text/javascript" src="<?php echo JS; ?>global/datatable.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/datatables/datatables.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/datatables/plugins/bootstrap/datatables.bootstrap.js"></script>
<!-- # Widget -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/counterup/jquery.waypoints.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/counterup/jquery.counterup.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-tabdrop/bootstrap-tabdrop.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-fileinput/bootstrap-fileinput.js"></script>
<!-- # Calendar -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/fullcalendar/fullcalendar.min.js"></script>
<!-- <script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-ui/jquery-ui.min.js"></script> -->
<!-- # Image Cropping -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jcrop/js/jquery.color.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jcrop/js/jquery.Jcrop.min.js"></script>
<!-- # Forms -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-tagsinput/bootstrap-tagsinput.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/typeahead/handlebars.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/typeahead/typeahead.bundle.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/autosize/autosize.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-repeater/jquery.repeater.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-select/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/select2/js/select2.full.min.js"></script>
<!-- # Text Editor -->
<!-- Note : Took from page component_editors.html -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wysihtml5/wysihtml5-0.3.0.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-markdown/lib/markdown.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-summernote/summernote.min.js"></script>
<!-- # Charts -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/morris/morris.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/morris/raphael-min.js"></script>
<!-- # Notifications -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-sweetalert/sweetalert.min.js"></script>
<!-- # Portfolio @ Light Gallery -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/cubeportfolio/js/jquery.cubeportfolio.min.js"></script>
<!-- # Validation -->
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-validation/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/jquery-validation/js/additional-methods.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
<!-- # Animation -->
<!-- <script type="text/javascript" src="<?php echo JS; ?>layout8/components/wow.min.js"></script> -->




<!-- GLOBAL -->
<script type="text/javascript" src="<?php echo JS; ?>global/app.js"></script>

<!-- APPS -->
<script type="text/javascript" src="<?php echo JS; ?>apps/calendar.js"></script>

<!-- PAGE -->
<script type="text/javascript" src="<?php echo JS; ?>pages/components-date-time-pickers.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/form-wizard-employer.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/dashboard.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/table-datatables-managed.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/form-repeater.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/form-image-crop.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/components-bootstrap-select.min.js"></script>
<!-- <script type="text/javascript" src="<?php echo JS; ?>pages/ui-modals.min.js"></script> -->
<script type="text/javascript" src="<?php echo JS; ?>pages/components-editors.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/ui-sweetalert.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>pages/portfolio-3.js"></script>

<!-- PAGE LAYOUT   -->
<script type="text/javascript" src="<?php echo JS; ?>layout2/layout.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>layout2/quick-sidebar.min.js"></script>
<script type="text/javascript" src="<?php echo JS; ?>layout2/quick-nav.min.js"></script>

<!-- # Custom -->
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/alertify.min.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/pass-strength.js"></script>s
<script type="text/javascript" src="<?php echo base_url(); ?>assets/global/plugins/Croppic/croppic.js"></script>





<script>
    $(document).ready(function () {
        var cropperOptions = {
            //uploadUrl:'<?=base_url()?>assets/global/plugins/Croppic/croppic/img_save_to_file.php',
            uploadUrl: '<?=base_url()?>student/gallery/img_save_to_file',
            cropUrl: '<?=base_url()?>student/gallery/img_crop_to_file',
            //cropUrl:'<?=base_url()?>assets/global/plugins/Croppic/croppic/img_crop_to_file.php',
            outputUrlId: 'myOutputId',
            imgEyecandy: false,
            imgEyecandyOpacity: 0.2,
            uploadData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            cropData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            rotateControls: false,
        };

        var cropperOptionsEdit = {
            uploadUrl: '<?=base_url()?>student/gallery/img_save_to_file',
            cropUrl: '<?=base_url()?>student/gallery/img_crop_to_file',
            outputUrlId: 'myOutputIdEdit',
            imgEyecandy: false,
            imgEyecandyOpacity: 0.2,
            uploadData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            cropData: {
                "dummyData": 1,
                "dummyData2": "text"
            },
            rotateControls: false,
        };

        var cropper = new Croppic('yourId', cropperOptions);

        var cropper_edit = new Croppic('yourIdEdit', cropperOptionsEdit);

        //cropper.destroy()   // no need explaining here :) 
        //cropper.reset()
        /*
            onBeforeImgUpload:  function(){ console.log('onBeforeImgUpload') },
            onAfterImgUpload:   function(){ console.log('onAfterImgUpload') },
            onImgDrag:      function(){ console.log('onImgDrag') },
            onImgZoom:      function(){ console.log('onImgZoom') },
            onBeforeImgCrop:    function(){ console.log('onBeforeImgCrop') },
            onAfterImgCrop:     function(){ console.log('onAfterImgCrop') },
            onReset:        function(){ console.log('onReset') },
            onError:        function(errormsg){ console.log('onError:'+errormsg)
            */

        //EDIT PHOTO GALLERY
        $(".edit_button_gallery").on("click", function () {
            //$('#featured_image_article').hide();
            var row_id = this.id;
            var res = row_id.split("_");

            row_id = res[1];
            $.ajax({
                url: "<?=base_url();?>student/gallery/get_data_array/" + row_id,
                method: "POST",
                success: function (response) {
                    var data = JSON.parse(response);
                    $('#title_gallery').val(data.title);
                    $('#description_gallery').val(data.description);
                    $('#myOutputIdEdit').val("/" + data.photo);
                    $('#myOutputIdEditOld').val("/" + data.photo);
                    $('#id_gallery').val(data.id);
                    $('#curr_photo').attr("src", "<?=base_url();?>assets/img/gallery/" + data.photo);

                    /*cropper_edit.destroy();                        
                    cropperOptionsEdit = {
                        uploadUrl:'<?=base_url()?>student/gallery/img_save_to_file',
                        cropUrl:'<?=base_url()?>student/gallery/img_crop_to_file',
                        outputUrlId:'myOutputIdEdit',
                        loadPicture:'<?=base_url();?>assets/img/gallery/'+data.photo,
                        imgEyecandy:false,
                        imgEyecandyOpacity:0.2,
                        rotateControls:false,
                    };
                    cropper_edit = new Croppic('yourIdEdit', cropperOptionsEdit);*/
                    cropper_edit.reset();

                }
            });
        });

        //SAVE PHOTO GALLERY
        $("#button_save_gallery").on("click", function () {
            if ($("#myOutputId").val() == "") {
                alert("You have not upload any photo yet!");
                return false;
            }
        });

        var last_seen_notif = "<?=$this->session->userdata('last_seen_notif')?>";
        var e = $("#xremo_table");
        e.dataTable({
            language: {
                aria: {
                    sortAscending: ": activate to sort column ascending",
                    sortDescending: ": activate to sort column descending"
                },
                emptyTable: "No data available in table",
                info: "Showing _START_ to _END_ of _TOTAL_ records",
                infoEmpty: "No records found",
                infoFiltered: "(filtered1 from _MAX_ total records)",
                lengthMenu: "Show _MENU_",
                search: "Search:",
                zeroRecords: "No matching records found",
                paginate: {
                    previous: "Prev",
                    next: "Next",
                    last: "Last",
                    first: "First"
                }
            },
            bStateSave: !0,
            lengthMenu: [
                [5, 15, 20, -1],
                [5, 15, 20, "All"]
            ],
            pageLength: 5,
            pagingType: "bootstrap_full_number",
            columnDefs: [{
                orderable: !1,
                targets: [0]
            }, {
                searchable: !1,
                targets: [0]
            }, {
                className: "dt-right"
            }],
            order: [
                //[1, "asc"]
            ]
        });

        $('#DOB').datepicker({
            format: 'dd-mm-yyyy',
            autoclose: true,
        });


        $(".date-picker-start").datepicker({
            format: 'dd-mm-yyyy',
            todayBtn: 1,
            autoclose: true,
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            $('.date-picker-end').datepicker('setStartDate', minDate);
        });

        $(".date-picker-end").datepicker({
            format: 'dd-mm-yyyy',
            autoclose: true,
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            $('.date-picker-start').datepicker('setEndDate', minDate);
        });

        $(".date-picker-start").keyup(function () {
            if (!this.value) {
                $(this).datepicker("clearDates");
            }
        });

        $(".date-picker-end").keyup(function () {
            if (!this.value) {
                $(this).datepicker("clearDates");
            }
        });


        $('.md-check').change(function () {
            if (this.checked) {
                $('.input-date-picker-end').prop("disabled", true);
                $('.input-date-picker-end').removeAttr("required");
            } else {
                $('.input-date-picker-end').removeAttr("disabled");
                $('.input-date-picker-end').attr("required");
            }
        });

        <?php if($this->session->flashdata('msg_success')){ ?>
        alertify.success('<?php echo $this->session->flashdata('msg_success'); ?>', 'success', 5);
        <?php } ?>
        <?php if($this->session->flashdata('msg_failed')){ ?>
        alertify.error('<?php echo $this->session->flashdata('msg_failed'); ?>', 'error', 5);
        <?php } ?>

        $(".btn-delete").click(function () {
            var data = $(this).attr('data-value');
            var table = $(this).attr('tb-val');
            alertify.confirm('Delete From List', 'Are you sure you want to delete?', function () {
                $.post("<?php echo base_url(); ?>student/profile/delete/", {
                    id: data,
                    table: table
                }, function (data) {
                    if (data == "false") {
                        alertify.error('Failed to delete record');
                    } else {
                        alertify.success('Record is deleted.');
                        location.reload();
                    }
                });
            }, function (data) {
                alertify.error('Cancel');
            });
        });
        $('.apply').click(function () {
            var apply = $(this).attr('id');
            swal({
                    title: "Are you sure?",
                    text: "You will apply this as your dream job",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Apply",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/dashboard/applied",
                            method: "POST",
                            data: {
                                job_id: parseInt(apply),
                            },
                            success: function (response) {
                                swal("Sucess", "Success apply your dream job.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "This job is not fit for you", "error");
                    }
                }
            );
        });
        $('.dlt-history').click(function () {
            var apply = $(this).attr('data-id');
            swal({
                    title: "Are you sure you want to withdraw?",
                    text: "You withdraw from this job",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "withdraw",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/applications_history/withdraw",
                            method: "POST",
                            data: {
                                job_id: parseInt(apply),
                            },
                            success: function (response) {
                                swal("Sucess", "Success withdraw this job.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "This job still fit for you", "error");
                    }
                }
            );
        });

        $('.btn-acc').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            swal({
                    title: "Are you sure you want to accept the invitation?",
                    text: "You accept the invitation",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Accept",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?php echo base_url();?>student/applications_history/accept_invitation",
                            method: "POST",
                            data: {
                                job_id: parseInt(job_id),
                                session_id: parseInt(session_id),
                                employer_id: parseInt(employer_id)
                            },
                            success: function (response) {
                                console.log(response);
                                swal("Sucess", "Success accept the invitation.", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "You still thinking about other possibilities", "error");
                    }
                }
            );
        });

        $('.search_company').click(function(){
            $.ajax({
                url: "<?= base_url(); ?>student/wishlist/get_company",
                method: "GET",
                data: {
                    company_name: $("#search_company").val()
                },
                success: function(response){
                    var company = JSON.parse(response);

                    if (window.location.host == 'localhost') {
                        var image_directory = window.location.origin + '/xremo/assets/img/employer/';
                    }else{
                        var image_directory = window.location.origin + '/assets/img/employer/';
                    }
                    var profile_pic = 'profile-pic.png';
                    var companies = "";
                    var canBeAddedToWishlist = true;
                    var companyName = "";
                    if(company.length > 0){
                        $.each(company, function (i, v) {
                            if (v.company_name != "") {
                                companyName = v.company_name;
                            }else{
                                companyName = v.registered_company;
                            }

                            companies += '<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">\
                                            <div class="mt-card-item wishlistCheckAvailability" companyId="'+v.id+'">\
                                                <div class="mt-card-avatar mt-overlay-1">\
                                                    <img src="' + v.profile_photo + '" class="img-fluid height-200 width-auto center-block">\
                                                    <div class="mt-overlay">\
                                                        <ul class="mt-info wishlistInfo">\
                                                        </ul>\
                                                    </div>\
                                                </div>\
                                                <div class="mt-card-content">\
                                                    <h3 class="mt-card-name">'+companyName+'</h3>\
                                                </div>\
                                            </div>\
                                        </div>';
                        });
                        $('.modal-footer .btn').addClass('hidden');
                        $('#company_result').css("display", "flex");
                        $('#company_result').css("flex-wrap", "wrap");
                    }else{
                        $('.modal-footer .btn').removeClass('hidden');
                        companies = '\
                            <div class="portlet portlet-body center-block width-60-percent py-100 px-30 text-center md-red-text">\
                                <p>Sorry!! "company name" not exist in our system.</p>\
                                <p>Its doesnt mean you cannot add your favourite company. </p>\
                            </div>\
                            <div class="row mx-0">\
                                <div class="col-md-8 col-md-offset-2">\
                                    <div class="form-group mx-0">\
                                        <label for="">Company Name</label>\
                                        <input type="text" class="form-control" name="companyName">\
                                    </div>\
                                    <div class="form-group mx-0">\
                                        <label for="">Why you want to join in this company? (Optional)</label>\
                                        <textarea name="wantToJoinReason" id="" cols="30" rows="4" class="form-control"></textarea>\
                                    </div>\
                                </div>\
                            </div>';
                        $('#company_result').removeAttr("style");
                    }
                    $('#company_result').html(companies);
                    $('.addWishlist').click(function(){
                        var $companyId = $(this).attr('companyId')
                        swal({
                            title: "Are you sure want to add this as your wishlist?",
                            text: "You will be able to remove it later",
                            type: "warning",
                            showCancelButton: true,
                            confirmButtonColor: "#DD6B55",
                            confirmButtonText: "Add",
                            cancelButtonText: "Cancel",
                            closeOnConfirm: false,
                            closeOnCancel: false
                        },
                        function (isConfirm) {
                            if (isConfirm) {
                                $.ajax({
                                    url: "<?= base_url(); ?>student/wishlist/addCompany",
                                    method: "POST",
                                    data: {
                                        companyId: $companyId
                                    },
                                    success: function(response){

                                        swal("Success", "Successfuly add company to job wishlist", "success");
                                        location.reload();
                                    }
                                })
                            } else {
                                swal("Cancelled", "Your Post is safe", "error");
                            }
                        }
                        );                        
                    });

                    $('.wishlistCheckAvailability').hover(function(){
                        $.ajax({
                            url: "<?= base_url(); ?>student/wishlist/checkWishlistAvailability",
                            method: "GET",
                            data: {
                                companyId: $(this).attr('companyId')
                            },
                            success: function(response){
                                var result = JSON.parse(response);
                                console.log(result);
                                if (result.response == 'exist') {
                                    $('.wishlistCheckAvailability .wishlistInfo').html('<li>\
                                                                 <a wishlistId="'+result.id+'" class="btn btn-md-red removeWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                                                     <i class="fa fa-close "></i>\
                                                                 </a>\
                                                             </li>');
                                }else{
                                    $('.wishlistCheckAvailability .wishlistInfo').html('<li>\
                                                                 <a companyId="'+$(this).attr('companyId')+'" class="btn btn-md-orange addWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                                                     <i class="fa fa-plus "></i>\
                                                                 </a>\
                                                             </li>');
                                }
                                // if (response == 'exist') {
                                //     canBeAddedToWishlist = '<li>\
                                //                                 <a wishlistId="'+v.wishlist_id+'" class="btn btn-md-red removeWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                //                                     <i class="fa fa-close "></i>\
                                //                                 </a>\
                                //                             </li>';

                                // }else{
                                //     canBeAddedToWishlist = '<li>\
                                //                                 <a companyId="'+$(this).attr('companyId')+'" class="btn btn-md-orange addWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                //                                     <i class="fa fa-plus "></i>\
                                //                                 </a>\
                                //                             </li>';
                                 
                                // }
                            }
                        });
                    })

                    $('.removeWishlist').click(function(){
                        var $wishlistId = $(this).attr('wishlistId');
                        swal({
                                title: "Are you sure you want to remove from your wishlist?",
                                text: "You will be able to add it later",
                                type: "warning",
                                showCancelButton: true,
                                confirmButtonColor: "#DD6B55",
                                confirmButtonText: "Delete",
                                cancelButtonText: "Cancel",
                                closeOnConfirm: false,
                                closeOnCancel: false
                            },
                            function (isConfirm) {
                                if (isConfirm) {
                                    $.ajax({
                                        url: "<?= base_url(); ?>student/wishlist/removeCompany",
                                        method: "POST",
                                        data: {
                                            wishlistId: $wishlistId
                                        },
                                        success: function(response){
                                            swal("Success", "Successfuly remove company to job wishlist", "success");
                                            location.reload();
                                        }
                                    })
                                } else {
                                    swal("Cancelled", "Your Post is safe", "error");
                                }
                            }
                        )
                        
                    });
                }
            });
        });

        $("#searchTextboxCorner").keyup(function(e){
            if (e.keyCode==13) {
                $.ajax({
                    url: "<?= base_url(); ?>student/wishlist/get_company",
                    method: "GET",
                    data: {
                        company_name: $("#search_company").val()
                    },
                    success: function(response){
                        var company = JSON.parse(response);

                        if (window.location.host == 'localhost') {
                            var image_directory = window.location.origin + '/xremo/assets/img/employer/';
                        }else{
                            var image_directory = window.location.origin + '/assets/img/employer/';
                        }
                        var profile_pic = 'profile-pic.png';
                        var companies = "";
                        var canBeAddedToWishlist = true;
                        var companyName = "";
                        if(company.length > 0){
                            $.each(company, function (i, v) {
                                console.log(v);
                                if (v.profile_photo != null) {
                                    profile_pic = v.profile_photo;
                                }else{
                                    profile_pic = 'profile-pic.png';
                                }

                                if (v.company_name != "") {
                                    companyName = v.company_name;
                                }else{
                                    companyName = v.registered_company;
                                }

                                if (v.wishlist_user_id == <?= $this->session->userdata('id');?> && (v.status == 1)) {
                                    canBeAddedToWishlist = '<li>\
                                                                <a wishlistId="'+v.wishlist_id+'" companyName="'+v.companyName+'" class="btn btn-md-red removeWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                                                    <i class="fa fa-close "></i>\
                                                                </a>\
                                                            </li>';

                                }else{
                                    canBeAddedToWishlist = '<li>\
                                                                <a companyId="'+v.id+'" class="btn btn-md-orange addWishlist" href="javascript:void(0);" data-dismiss="modal">\
                                                                    <i class="fa fa-plus "></i>\
                                                                </a>\
                                                            </li>';
                                 
                                }

                                companies += '<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">\
                                                <div class="mt-card-item">\
                                                    <div class="mt-card-avatar mt-overlay-1">\
                                                        <img src="' + v.profile_photo + '" class="img-fluid height-200 width-auto center-block">\
                                                        <div class="mt-overlay">\
                                                            <ul class="mt-info">\
                                                                '+canBeAddedToWishlist+'\
                                                            </ul>\
                                                        </div>\
                                                    </div>\
                                                    <div class="mt-card-content">\
                                                        <h3 class="mt-card-name">'+companyName+'</h3>\
                                                    </div>\
                                                </div>\
                                            </div>';
                            });
                            $('.modal-footer .btn').addClass('hidden');
                            $('#company_result').css("display", "flex");
                            $('#company_result').css("flex-wrap", "wrap");
                        }else{
                            $('.modal-footer .btn').removeClass('hidden');
                            companies = '\
                                <div class="portlet portlet-body center-block width-60-percent py-100 px-30 text-center md-red-text">\
                                    <p>Sorry!! "company name" not exist in our system.</p>\
                                    <p>Its doesnt mean you cannot add your favourite company. </p>\
                                </div>\
                                <div class="row mx-0">\
                                    <div class="col-md-8 col-md-offset-2">\
                                        <div class="form-group mx-0">\
                                            <label for="">Company Name</label>\
                                            <input type="text" class="form-control" name="companyName">\
                                        </div>\
                                        <div class="form-group mx-0">\
                                            <label for="">Why you want to join in this company? (Optional)</label>\
                                            <textarea name="wantToJoinReason" id="" cols="30" rows="4" class="form-control"></textarea>\
                                        </div>\
                                    </div>\
                                </div>';
                            $('#company_result').removeAttr("style");
                        }
                        $('#company_result').html(companies);
                        $('.addWishlist').click(function(){
                            var $companyId = $(this).attr('companyId')
                            swal({
                                title: "Are you sure want to add this as your wishlist?",
                                text: "You will be able to remove it later",
                                type: "warning",
                                showCancelButton: true,
                                confirmButtonColor: "#DD6B55",
                                confirmButtonText: "Add",
                                cancelButtonText: "Cancel",
                                closeOnConfirm: false,
                                closeOnCancel: false
                            },
                            function (isConfirm) {
                                if (isConfirm) {
                                    $.ajax({
                                        url: "<?= base_url(); ?>student/wishlist/addCompany",
                                        method: "POST",
                                        data: {
                                            companyId: $companyId
                                        },
                                        success: function(response){

                                            swal("Success", "Successfuly add company to job wishlist", "success");
                                            location.reload();
                                        }
                                    })
                                } else {
                                    swal("Cancelled", "Your Post is safe", "error");
                                }
                            }
                            );                        
                        });

                        $('.removeWishlist').click(function(){
                            var $wishlistId = $(this).attr('wishlistId');
                            swal({
                                    title: "Are you sure you want to remove from your wishlist?",
                                    text: "You will be able to add it later",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonColor: "#DD6B55",
                                    confirmButtonText: "Delete",
                                    cancelButtonText: "Cancel",
                                    closeOnConfirm: false,
                                    closeOnCancel: false
                                },
                                function (isConfirm) {
                                    if (isConfirm) {
                                        $.ajax({
                                            url: "<?= base_url(); ?>student/wishlist/removeCompany",
                                            method: "POST",
                                            data: {
                                                wishlistId: $wishlistId
                                            },
                                            success: function(response){
                                                swal("Success", "Successfuly remove company to job wishlist", "success");
                                                location.reload();
                                            }
                                        })
                                    } else {
                                        swal("Cancelled", "Your Post is safe", "error");
                                    }
                                }
                            )
                            
                        });
                    }
                });
            }
        })

        $('.removeWishlist').click(function(){
            var $wishlistId = $(this).attr('wishlistId');
            swal({
                    title: "Are you sure you want to remove from your wishlist?",
                    text: "You will be able to add it later",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Delete",
                    cancelButtonText: "Cancel",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: "<?= base_url(); ?>student/wishlist/removeCompany",
                            method: "POST",
                            data: {
                                wishlistId: $wishlistId
                            },
                            success: function(response){
                                swal("Success", "Successfuly remove company to job wishlist", "success");
                                location.reload();
                            }
                        })
                    } else {
                        swal("Cancelled", "Your Post is safe", "error");
                    }
                }
            )
            
        });

        $('.btn-resc').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            $('#modal_rescheduled_form .job-id').val(job_id);
            $('#modal_rescheduled_form .session-id').val(session_id);
            $('#modal_rescheduled_form .employer-id').val(employer_id);
        });

        $('.btn-rej').click(function () {
            $('.modal_detail_interview').modal('hide');
            var job_id = $(this).attr('job-id');
            var session_id = $(this).attr('session-id');
            var employer_id = $(this).attr('employer-id');
            $('#modal_reject_form .job-id').val(job_id);
            $('#modal_reject_form .session-id').val(session_id);
            $('#modal_reject_form .employer-id').val(employer_id);
        });

        $("#searchable_detail").bootstrapSwitch({
            size: 'mini',
            onSwitchChange: function (event, state) {
                var parentClass = $(this).parent().parent();
                var searchable_detail = 0;

                if (parentClass.hasClass('bootstrap-switch-on')) {
                    searchable_detail = 1;
                }

                $.ajax({
                    url: "<?php echo base_url();?>student/settings/changeSearchableDetail",
                    method: "POST",
                    data: {
                        status: searchable_detail
                    },
                    success: function (response) {
                        if (searchable_detail == 1) {
                            swal("Success", "Your contact detail are now searchable to employers.", "success");
                        } else {
                            swal("Success", "Your contact detail are now unavailable to employers.", "success");
                        }
                    }
                });
            }
        });

        $("#searchable").bootstrapSwitch({
            size: 'mini',
            onSwitchChange: function (event, state) {
                var parentClass = $(this).parent().parent();
                var searchable = 0;

                if (parentClass.hasClass('bootstrap-switch-on')) {
                    searchable = 1;
                }

                $.ajax({
                    url: "<?php echo base_url();?>student/settings/changeSearchable",
                    method: "POST",
                    data: {
                        status: searchable
                    },
                    success: function (response) {
                        if (searchable == 1) {
                            $("#searchable_detail_content").addClass('hidden');
                            $('#searchable_detail').bootstrapSwitch('state', false);
                            swal("Success", "Your contact are now unavailable to employers.", "success");
                        } else {
                            $('#searchable_detail').bootstrapSwitch('state', true);
                            $("#searchable_detail_content").removeClass('hidden');
                            swal("Success", "Your contact are now searchable to employers.", "success");
                        }
                    }
                });
            }
        });

        <?php if ($this->uri->segment(2) == 'dashboard' || $this->uri->segment(2) == 'calendar') {?>
        var AppCalendar = function () {

            return {
                //main function to initiate the module
                init: function () {
                    this.initCalendar();
                },

                initCalendar: function () {

                    if (!jQuery().fullCalendar) {
                        return;
                    }

                    var date = new Date();
                    var d = date.getDate();
                    var m = date.getMonth();
                    var y = date.getFullYear();

                    var h = {};

                    if (App.isRTL()) {
                        if ($('#fullcalendar').parents(".portlet").width() <= 720) {
                            $('#fullcalendar').addClass("mobile");
                            h = {
                                right: 'title, prev, next',
                                center: '',
                                // left: 'agendaDay, agendaWeek, month, today'
                                left: ' month, today'
                            };
                        } else {
                            $('#fullcalendar').removeClass("mobile");
                            h = {
                                right: 'title',
                                center: '',
                                // left: 'agendaDay, agendaWeek, month, today, prev,next'
                                left: ' month, today, prev,next'
                            };
                        }
                    } else {
                        if ($('#fullcalendar').parents(".portlet ").width() <= 720) {
                            $('#fullcalendar').addClass("mobile");
                            h = {
                                left: 'title, prev, next',
                                center: '',
                                // right: 'today,month,agendaWeek,agendaDay'
                                right: 'month,agendaWeek'
                            };
                        } else {
                            $('#fullcalendar').removeClass("mobile");
                            h = {
                                left: 'title',
                                center: '',
                                // right: 'prev,next,today,month,agendaWeek,agendaDay'
                                right: 'prev,next,month,agendaWeek'
                            };
                        }
                    }

                    $('#fullcalendar').fullCalendar('destroy');
                    var invitation = <?php echo $invitation; ?>;
                    var invitation_calendar = [];
                    $.each(invitation, function (i, v) {
                        var color = '';

                        if (v.status == 'accept') {
                            color = 'green';
                        } else if (v.status == 'reject') {
                            color = 'red';
                        } else if (v.status == 'pending') {
                            color = 'yellow';
                        } else if (v.status == 'reschedule') {
                            color = 'blue';
                        } else {
                            color = 'grey';
                        }

                        invitation_calendar.push({
                            id: v.id,
                            title: v.title,
                            start: v.start_date,
                            end: v.end_date,
                            backgroundColor: App.getBrandColor(color)
                        })
                    });

                    $('#fullcalendar').fullCalendar({
                        header: h,
                        defaultView: 'month',
                        slotMinutes: 15,
                        editable: false,
                        droppable: false,
                        events: invitation_calendar,
                        eventClick: function (invitation_calendar, jsEvent, view) {
                            $('#modal_info_' + invitation_calendar.id).modal();
                        },
                    });

                }

            };

        }();

        AppCalendar.init();
        <?php } ?>

        $('#notif_msg').slimScroll({
            height: '250px'
        });

        showNotif();

        setInterval(function () {
            showNotif()
        }, <?= GetInterval(); ?>);

        $("#count_notif").on("click", function () {
            $.ajax({
                url: "<?php echo base_url();?>setLastSeenNotif",
                method: "POST",
                success: function (response) {
                    //var data = JSON.parse(response);
                    //last_seen_notif = data.last_seen_notif;
                }
            });
        });

        $('[data-toggle="tooltip"]').tooltip()

        $('#modal_edit_job_preferences input[type="checkbox"]').on('click', function() {
            let idInput = $(this).attr('data-trigger')
            let isChecked = $('#'+$(this).attr('id')+':checked').length

            if(isChecked > 0)
            {
                $('#'+idInput).removeClass('hidden')
            }
            else
            {
                $('#'+idInput).addClass('hidden')
            }
        })

        $(".select2-opt").select2({
            placeholder: "Country",
            allowClear: true,
            theme: "bootstrap"
        })
    });

    function showNotif() {
        $.ajax({
            url: "<?php echo base_url();?>notif",
            method: "POST",
            success: function (response) {
                var data = JSON.parse(response);

                if (data.message == "success") {
                    $("#notif_msg").html(data.notif);
                    $("#count_notif").html(data.total);
                    $("#count_notif_in").html(data.total_in);
                }
            }
        });
    }

    function notif_list(param) {
        var source = param.getAttribute('data-source');

        $.ajax({
            url: "<?php echo base_url();?>clear-notif",
            method: "POST",
            data: {
                id: source
            },
            success: function (response) {
                var data = JSON.parse(response);

                if (data.message == "success") {
                    location.href = data.url;
                }
            }
        });
    }

    // For Edit Profile
    $('.nav.navProfile li a').click(function (e) {
        //remove all pre-existing active classes
        $('.nav.navProfile li.active').removeClass('active');

        var $parent = $(this).parent();
        $parent.addClass('active');
        //Load the content
        //e.g.
        //load the page that the link was pointing to
        $('.navProfile').load($(this).find(a).attr('href'));
        //$('.navProfile').load($(this).attr('href'));
        e.preventDefault();
    });

</script>

</body>

</html>
